@using Umbraco.Cms.Web.Common.PublishedModels;
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@using Umbraco.Cms.Core.Models

@{
	Layout = "masterTemplate.cshtml";
	var BlogHeaderImage = Model.Value<MediaWithCrops>("blogHeaderImage");
	var HomePage = Model.Root();
}
@{

	int pageSize = 6;
	int page = 1;

	if (!int.TryParse(Context.Request.Query["page"], out page))
	{
		page = 1;
	}
	var selection = Umbraco.Content(Guid.Parse("6225fd59-0f21-401f-9f0a-a2a6901bee8e"))
				.ChildrenOfType("article")
				.Where(x => x.IsVisible())
				.OrderBy(x => x.CreateDate);

	int totalNodes = selection.Count();
	int totalPages = (int)Math.Ceiling((double)totalNodes / pageSize);

	if (page < 1) page = 1;
	else if (page > totalPages) page = totalPages;

	var paginatedItems = selection.Skip((page - 1) * pageSize).Take(pageSize);
	int itemCount = selection.Count();



}
<!-- Title Bar -->
<div class="pbmit-title-bar-wrapper">
	<div class="container">
		<div class="pbmit-title-bar-content">
			<div class="pbmit-title-bar-content-inner">
				<div class="pbmit-tbar">
					<div class="pbmit-tbar-inner container">
						<h1 class="pbmit-tbar-title">@Model.Value("blogHeaderTitle")</h1>
					</div>
				</div>
				<div class="pbmit-breadcrumb">
					<div class="pbmit-breadcrumb-inner">
						<span>
							<a title="" href="@HomePage.Url()" class="home"><span>Home</span></a>
						</span>
						<span class="sep"></span>
						<span><span class="post-root post post-post current-item">@Model.Name</span></span>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- Title Bar End-->

<div class="page-content">

	<!-- Blog Grid Col 3 -->
	<section class="section-md">
		<div class="container">
			<div class="row pbmit-element-posts-wrapper">




				@*
			@{
				var selection = Umbraco.Content(Guid.Parse("6225fd59-0f21-401f-9f0a-a2a6901bee8e"))
				.ChildrenOfType("article")
				.Where(x => x.IsVisible())
				.OrderBy(x => x.CreateDate);
			}
			*@
				@foreach (var item in paginatedItems)
				{

					var BlogImage = item.Value<MediaWithCrops>("heroImage");
					var blogDate = item.Value<DateTime>("date");


					<article class="pbmit-blog-style-1 col-md-6 col-lg-4">
						<div class="post-item">
							<div class="pbminfotech-box-content">
								<div class="pbmit-featured-container">
									<div class="pbmit-featured-container-inner">
										<div class="pbmit-featured-img-wrapper">
											<div class="pbmit-featured-wrapper">
												<img src="@BlogImage?.MediaUrl()" class="img-fluid" alt="@BlogImage?.Name">
											</div>
										</div>
										<a class="pbmit-link" href="@item.Url()"></a>
									</div>
									<div class="pbmit-meta-date-wrapper pbmit-meta-line">
										<span class="pbmit-post-date">
											<span class="pbmit-date">@blogDate.ToString("dd")</span>
											<span class="pbmit-month">@blogDate.ToString("MMM")</span>
											@*<span class="pbmit-month">@blogDate.ToString("yyyy")</span>*@

										</span>
									</div>
									<div class="pbmit-meta-wraper">

										<div class="pbmit-meta-category-wrapper pbmit-meta-line">
											<span class="pbmit-meta-category">


												<a href="javascript:void(0);" rel="category tag">@item.Value("articleCategory")</a>


											</span>
										</div>

									</div>
								</div>
								<div class="pbmit-content-wrapper">
									<h3 class="pbmit-post-title">
										<a href="@item.Url()">@item.Value("title")</a>
									</h3>
									<div class="pbminfotech-box-desc">
										@item.Value("summary")
									</div>
									<div class="pbmit-blog-btn">
										<a class="pbmit-button-inner" href="@item.Url()">
											<span class="pbmit-button-text">Read More</span>
											<span class="pbmit-button-icon">
												<i class="pbmit-base-icon-right-arrow"></i>
											</span>
										</a>
									</div>
								</div>
							</div>
						</div>
					</article>
				}






				<!-- Pagination -->
				<div class="pagination-bx clearfix text-center">
					<ul class="pagination justify-content-center">

						<!-- Prev -->
						<li class="previous @(page <= 1 ? "disabled" : "")">
							<a href="@(page > 1 ? (page - 1 == 1 ? "/blog" : $"/blog?page={page - 1}") : "javascript:void(0);")">
								<i class="ti-arrow-left"></i> Prev
							</a>
						</li>

						<!-- Pages -->
						@for (int i = 1; i <= totalPages; i++)
						{
							<li class="@(i == page ? "active" : "")">
								<a href="@(i == 1 ? "/blog" : $"/blog?page={i}")">
									@i
								</a>
							</li>
						}

						<!-- Next -->
						<li class="next @(page >= totalPages ? "disabled" : "")">
							<a href="@(page < totalPages ? $"/blog?page={page + 1}" : "javascript:void(0);")">
								Next <i class="ti-arrow-right"></i>
							</a>
						</li>

					</ul>
				</div>



				<div class="workspaces-filter">
					<div class="workspaces-count">Total Blogs is @itemCount</div>
				</div>
			</div>
		</div>
	</section>
	<!-- Blog Grid Col 3 End -->

</div>